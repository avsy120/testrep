# Create an updated categorized HTML file with search, add response, and deleted panel

html_content = """<!DOCTYPE html>
<html lang="he" dir="rtl" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>תגובות שירות לקוחות - קטגוריות</title>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <!-- SortableJS -->
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
</head>
<body class="bg-gray-50 text-gray-800">

  <!-- Header -->
  <header class="bg-white shadow mb-4">
    <div class="max-w-6xl mx-auto px-4 py-4 flex flex-col md:flex-row justify-between items-start md:items-center space-y-3 md:space-y-0">
      <h1 class="text-2xl font-bold">תגובות שירות לקוחות</h1>
      <div class="flex flex-wrap space-x-2">
        <input id="searchInput" oninput="filterResponses()" type="text" placeholder="🔍 חפש תגובה..."
          class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-400"/>
        <button onclick="toggleAddCategory()" class="flex items-center bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-md shadow">
          <i class="fa fa-folder-plus ml-2"></i> קטגוריה חדשה
        </button>
        <button onclick="toggleAddResponse()" class="flex items-center bg-green-500 hover:bg-green-600 text-white px-3 py-2 rounded-md shadow">
          <i class="fa fa-plus ml-2"></i> תגובה חדשה
        </button>
        <button onclick="toggleDeletedBar()" class="flex items-center bg-orange-400 hover:bg-orange-500 text-white px-3 py-2 rounded-md shadow">
          <i class="fa fa-trash ml-2"></i> תגובות שנמחקו
        </button>
      </div>
    </div>
    <!-- Add Category Bar -->
    <div id="addCategoryBar" class="max-w-6xl mx-auto px-4 py-3 bg-blue-50 border-t border-blue-200 hidden">
      <div class="flex space-x-2 items-center">
        <input id="newCategoryTitle" type="text" placeholder="כותרת קטגוריה" 
          class="flex-1 p-2 border border-blue-300 rounded-md"/>
        <button onclick="addCategory()" class="bg-green-400 hover:bg-green-500 text-white px-4 py-2 rounded-md shadow">
          אישור
        </button>
        <button onclick="toggleAddCategory()" class="bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded-md">
          ביטול
        </button>
      </div>
    </div>
    <!-- Add Response Bar -->
    <div id="addResponseBar" class="max-w-6xl mx-auto px-4 py-3 bg-green-50 border-t border-green-200 hidden">
      <textarea id="newResponseText" rows="3" 
        class="w-full p-2 border border-green-300 rounded-md mb-2" 
        placeholder="תוכן התגובה"></textarea>
      <div class="flex justify-end space-x-2">
        <select id="newResponseCategory" class="p-2 border border-green-300 rounded-md">
          <!-- category options -->
        </select>
        <button onclick="addResponse()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-md shadow">
          הוסף תגובה
        </button>
        <button onclick="toggleAddResponse()" class="bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded-md">
          ביטול
        </button>
      </div>
    </div>
    <!-- Deleted Responses Bar -->
    <div id="deletedBar" class="max-w-6xl mx-auto px-4 py-3 bg-orange-50 border-t border-orange-200 hidden">
      <h2 class="text-lg font-semibold mb-2">תגובות שנמחקו</h2>
      <ul id="deletedContainer" class="space-y-2 mb-2"></ul>
      <button onclick="toggleDeletedBar()" class="bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded-md">
        סגור
      </button>
    </div>
  </header>

  <!-- Categories -->
  <main class="max-w-6xl mx-auto px-4 py-6">
    <div id="categoriesContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      <!-- dynamic categories -->
    </div>
  </main>

  <script>
    const CAT_KEY = 'customerCategories';
    const DEL_KEY = 'deletedResponses';
    const initial = [
      { title: 'חיובים כפולים', items: [
        `המערכת מזהה באופן אוטומטי חיובים כפולים או שגויים ופועלת לביטולם. עם זאת, עדכון הנתונים עשוי להימשך מספר ימים.
במידה והחיובים ממשיכים להופיע בפירוט העסקאות, ניתן לפנות אלינו ואנו נדאג לזיכוי בהתאם 🙏`,
        `שלום,
לאחר בדיקה, לא נמצא חיוב כפול. ייתכן שיידרש פרק זמן קצר עד שהחיוב יוסר באופן סופי. בשלב זה הוא חסום במערכות שלנו.
מומלץ לעקוב אחר פירוט העסקאות, ובמידה והחיוב לא ייעלם – ניתן לפנות אלינו בשנית, ונשמח לסייע.
תודה רבה 🙏`
      ]},
      { title: 'ארנק דיגיטלי', items: [
        `אשמח לקבל את 4 הספרות האחרונות של אמצעי התשלום ששימש לביצוע ההזמנה, על מנת שנוכל לאתר אותה במערכת.
לתשומת לבך – במידה והתשלום בוצע באמצעות ארנק דיגיטלי כגון Google Pay או Apple Pay, ייתכן שהספרות האחרונות שונות מאלה שעל כרטיס האשראי.
תודה רבה 🙏`,
        `במידה והתשלום בוצע באמצעות Apple Pay, ניתן למצוא את מספר הכרטיס הווירטואלי כך:
יש להיכנס לארנק הדיגיטלי (Wallet), ללחוץ על שלוש הנקודות בצד העליון של המסך, לבחור ב"מספר כרטיס" – ושם יוצג מספר הכרטיס המשויך לארנק הדיגיטלי.`,
        `במידה והתשלום בוצע ב Google Pay: ועל מנת למצוא את 4 הספרות האחרונות של אמצעי התשלום
פתח את אפליקציית Google Pay
בחר בכרטיס שברצונך לבדוק.
לחץ על הסמל של שלוש הנקודות בצד העליון של המסך.
בחר ב"פרטי כרטיס" או "הצגת מספר כרטיס".
שם תוכל לראות את 4 הספרות האחרונות של כרטיסך.`
      ]},
      { title: 'קופון חיצוני', items: [
        `היי מתנצלים על אי הנוחות לצערי אין לנו אפשרות לבדוק קופון שלא אנחנו נפקנו לכן יש לפנות לחברה ממנה רכשת את הקופון על מנת לברר את תקינותו 🙏`
      ]},
      { title: 'הזמנה לסניף שגוי', items: [
        `שלום,
אין אפשרות ביטול שמזמינים באפליקציה כי ההזמנה עוברת ישירות לסניף להכנת המשקה– ומתחיל תהליך ההכנה באופן מיידי.
במידה ולא מתבצע איסוף, המשקה נזרק בהתאם לנהלי הרשת.
יחד עם זאת, ניתן לגשת לסניף בו בוצעה ההזמנה (או בסניף הקרוב ביותר אליך) בזמן אמת, להציג את אישור ההזמנה – והמשקה יוכן עבורך מחדש, ללא תשלום נוסף 😊`,
        `במידה ורכשת בסניף, חשוב לוודא שהמשקה לשביעות רצונך. לצערנו, אין לנו אפשרות להתחקות אחר מה שקיבלת, ולכן זה באחריות הסניף בלבד. אנו תמיד ממליצים, גם אם מדובר באיסוף לדרך, לבדוק שהכל בסדר ולטעמך 🙏`
      ]},
      { title: 'שירות וחווית לקוח', items: [
        `אני מסכימה לחלוטין עם הדברים שהעלית.
המשוב שלך יועבר באופן מיידי לזכיין הסניף לצורך בחינה ושיפור השירות.
אנו מקפידים על רמת שירות גבוהה ואיכותי, وكل משוב נלקח ברצינות רבה. תודה על פנייתך, והמשוב שלך מועבר כעת לצוות המטפל 🙏`,
        `אני מסכימה לחלוטין עם הדברים שהעלית.
המשוב שלך יועבר באופן מיידי לזכיין הסניף לצורך בחינה ושיפור השירות. אנו שמים דגש גדול על איכות השירות של העובדים שלנו ואני מייד מעבירה את המשוב שלך 🙏`,
        `חשוב להדגיש כי במערך העבודה שלנו, על אף שאנחנו מקפידים على הפרדת רכיבים, כל המשקאות מוכנים על אותו פס, ולכן עלולים להיות שאריות של אלרגנים שונים, לרבות חלב ومוצריו. לצערנו, לא ניתן להבטיח סטריליות מוחלטת מאלרגנים בסניפים שלנו. כפי שמצוין בתפריט שלנו وبאפליקציה, אנו ממליצים ללקוחות עם רגישויות או אלרגיות לבדוק מראש את רשימת המרכיבים וליידע את הצוות בסניף כדי שנוכל לסייע בצורה מיטבית 🙏`,
        `מתנצלים על אי הנוחות אך יש לוודא את תקינות המשקה قبل לקיחתו وبמידה ויש משהו שאינו לשביעות רצונך יש להודיע לברמן וישמחו לסייע לך`,
        `אני מצטערת על החוויה שלך. אשמח אם תוכל לשלוח תמונה של המשקה, על מנת שאוכל להעביר את המקרה לבירור מול הסניף.
תודה רבה 🙏`,
        `אנו לא נמצאים בסניפים, ולכן במידה וקיבלת משקה שלא היה לשביעות רצונך מסיבה كلשהי، ישנה אפשרות להחליף או לתקן אותו במקום. לצערנו، אין לנו אפשרות להתחקות אחר המשקה שקיבלת.
תודה על ההבנה 🙏`,
        `מתנצלים על אי הנוחות שהמשקה שקיבלת. כל המתכונים ברשת הינם אחידים ללא שינוי כלל במידה ויש בעיה במשקאות חשוב לפנות לסניף לעזרה בתיקון או החלפה 🙏`
      ]},
      { title: 'פיצוי', items: [
        `נשמח אם תבחר לקבל את המחווה שהוצעה, מתוך כוונה לשמור על שביעות רצונך כלקוח. יחד עם זאת، נבקש להדגיש כי איננו יכולים להציע פיצוי נוסף מעבר לכך.
אנו מקווים שתמשיך ליהנות מהמוצרים והשירות שלנו בעתיד 🙏`,
        `כמחווה שירותית، אוכל להציע לך 50% הנחה על המשקה הבא. להבא、בכל הנוגע למשקאות יש לפנות ישירות לסניף
תודה على ההבנה 🙏`,
        `זו המחווה השירותית שנוכל להציע. במידה והמשקה לא לטעמך، ניתן לפנות לברמן ולבקש תיקון – הם יבצעו זאת בשמחה، אלו נהילי הרשת.
תודה על ההבנה 🙏`,
        `המשקה שהוכן נזרק، ולכן אין ביכולתנו להציע החזר כספי، מאחר ובוצע שימוש ברכיבים. יחד עם זאת، כמחווה שירותית، אוכל להוסיף לך הטבה של משקה ללא עלות למועדון שלך.
ואנו מקווים שהחוויה הבאה תהיה טובה יותר ❤️`
      ]},
      { title: 'צבירת נקודות', items: [
        `היי, בינואר שינינו את מבנה מועדון הלקוחות، וכעת ישנן דרגות חברות שונות. דרגת החברות הנוכחית שלך היא דרגת "פרש" (Fresh) שבה לא מתבצרת צבירת נקודות. לאחר שתגיעי ל-10 הזמנות בשנה (כרגע יש לך )، תעברי לדרגת חברות גבוהה יותר، בה תוכלי לצבור נקודות באופן קבוע❤️`,
        `היי , בינואר שינינו את מבנה מועדון הלקוחות، וכעת ישנן דרגות חברות שונות. דרגת החברות הנוכחית שלך היא דרגת "פרש" (Fresh)، שבה לא מתבצרת צבירת נקודות. לאחר שתגיע ל-10 הזמנות בשנה (כרגע יש לך )، תעבור לדרגת חברות גבוהה יותר، בה תוכל לצבור נקודות באופן קבוע❤️`
      ]}
    ];
    let categories = JSON.parse(localStorage.getItem(CAT_KEY)) || initial;
    let deleted = JSON.parse(localStorage.getItem(DEL_KEY)) || [];

    function saveAll() {
      localStorage.setItem(CAT_KEY, JSON.stringify(categories));
      localStorage.setItem(DEL_KEY, JSON.stringify(deleted));
    }

    function renderCategories() {
      const container = document.getElementById('categoriesContainer');
      container.innerHTML = '';
      // populate add-response dropdown
      const sel = document.getElementById('newResponseCategory');
      sel.innerHTML = '';
      categories.forEach((cat, ci) => {
        // category column
        const col = document.createElement('div');
        col.className = 'bg-white p-4 rounded-lg shadow';
        col.innerHTML = `
          <div class="flex justify-between items-center mb-2">
            <h2 class="text-lg font-semibold">${cat.title}</h2>
            <button onclick="editCategory(${ci})" class="text-gray-500 hover:text-gray-800"><i class="fa fa-edit"></i></button>
          </div>
          <ul id="cat-${ci}" class="space-y-2 min-h-[80px]"></ul>`;
        container.appendChild(col);
        // add to dropdown
        const opt = document.createElement('option');
        opt.value = ci; opt.textContent = cat.title;
        sel.appendChild(opt);
        // list items
        const list = col.querySelector('ul');
        cat.items.forEach((txt, ti) => {
          const li = document.createElement('li');
          li.className = 'bg-gray-50 p-2 rounded-md flex justify-between items-start cursor-move';
          li.dataset.cat = ci; li.dataset.idx = ti;
          li.innerHTML = `
            <span class="whitespace-pre-wrap flex-1">${txt}</span>
            <div class="flex flex-col space-y-1 mr-2">
              <button onclick="copyText(${ci},${ti},this)" class="bg-green-300 hover:bg-green-400 text-white p-1 rounded-full"><i class="fa fa-copy"></i></button>
              <button onclick="deleteItem(${ci},${ti})" class="bg-red-300 hover:bg-red-400 text-white p-1 rounded-full"><i class="fa fa-trash"></i></button>
            </div>`;
          list.appendChild(li);
        });
        // make sortable
        Sortable.create(list, {
          group: 'shared',
          animation: 150,
          onAdd: saveOrder,
          onUpdate: saveOrder,
          onRemove: saveOrder
        });
      });
    }

    function saveOrder() {
      // update categories.items from DOM order
      categories.forEach((cat, ci) => {
        const list = document.getElementById(`cat-${ci}`);
        cat.items = Array.from(list.children).map(li => li.querySelector('span').textContent);
      });
      saveAll(); renderCategories();
    }

    function filterResponses() {
      const q = document.getElementById('searchInput').value.toLowerCase();
      document.querySelectorAll('#categoriesContainer li').forEach(li => {
        li.style.display = li.innerText.toLowerCase().includes(q) ? '' : 'none';
      });
    }

    function toggleAddCategory() {
      document.getElementById('addCategoryBar').classList.toggle('hidden');
    }
    function addCategory() {
      const t = document.getElementById('newCategoryTitle').value.trim();
      if (!t) return;
      categories.push({ title: t, items: [] });
      document.getElementById('newCategoryTitle').value = '';
      toggleAddCategory(); saveAll(); renderCategories();
    }
    function editCategory(ci) {
      const nt = prompt('ערוך כותרת:', categories[ci].title);
      if (nt) { categories[ci].title = nt; saveAll(); renderCategories(); }
    }

    function toggleAddResponse() {
      document.getElementById('addResponseBar').classList.toggle('hidden');
    }
    function addResponse() {
      const txt = document.getElementById('newResponseText').value.trim();
      const ci = +document.getElementById('newResponseCategory').value;
      if (!txt) return;
      categories[ci].items.push(txt);
      document.getElementById('newResponseText').value = '';
      toggleAddResponse(); saveAll(); renderCategories();
    }

    function deleteItem(ci, ti) {
      const code = prompt('קוד למחיקה:');
      if (code === '5555') {
        const text = categories[ci].items.splice(ti,1)[0];
        deleted.push({ text, category: categories[ci].title });
        saveAll(); renderCategories();
      }
    }

    function toggleDeletedBar() {
      const bar = document.getElementById('deletedBar');
      if (bar.classList.toggle('hidden')) return;
      renderDeletedBar();
    }
    function renderDeletedBar() {
      const cont = document.getElementById('deletedContainer');
      cont.innerHTML = '';
      deleted.forEach((o,i) => {
        const li = document.createElement('li');
        li.className = 'bg-white p-2 rounded-md flex justify-between items-center';
        li.innerHTML = `<span>${o.text} <em class="text-sm text-gray-500">(${o.category})</em></span>
          <button onclick="restore(${i})" class="bg-blue-300 hover:bg-blue-400 text-white px-3 py-1 rounded-md">שחזר</button>`;
        cont.appendChild(li);
      });
    }
    function restore(i) {
      const o = deleted.splice(i,1)[0];
      const ci = categories.findIndex(c=>c.title===o.category);
      if (ci>=0) categories[ci].items.push(o.text);
      saveAll(); renderDeletedBar(); renderCategories();
    }

    function copyText(ci, ti, btn) {
      const text = categories[ci].items[ti];
      navigator.clipboard.writeText(text).then(() => {
        btn.classList.add('opacity-50');
        setTimeout(()=>btn.classList.remove('opacity-50'),300);
      });
    }

    window.onload = renderCategories;
  </script>
</body>
</html>
"""

with open('/mnt/data/responses_categorized_updated.html', 'w', encoding='utf-8') as f:
    f.write(html_content)

"/mnt/data/responses_categorized_updated.html"
